文/赵霏 （磊友科技创始人）授权搜狐IT发布
　　去年11月份我们开始决定进行HTML5手机页游《猎魔佣兵》的iOS版本打包工作。这也是我们首次进行iOS版本的封包，因此前坊间有各种各样说法流传，苹果已经对WebApp加大了审核的严格程度，有一大批HTML5的游戏和应用纷纷都被斩于马下。带着这样忐忑不安的心情，我们开始了将手中基于HTML5开发的角色扮演网游《猎魔佣兵》封包上线的悲壮之路，期间历经各种坎坷又峰回路转，跌宕起伏，很值得回味。我不敢敝帚自珍，于是一一记录下来，以飨读者。







手机页游：《猎魔佣兵》 




　　1）游戏封包仓促上线，产品定价遭遇冷脸
　　项目会后我们把需求提给技术人员，起初大家并没有把这个事情看的很难，因为我们的HTML5游戏引擎完全是自主研发的，而内核采用的是Canvas和Dom混合模式。我们预先设定的方案也是直接在苹果平台上用Xcode进行打包，把自己的Javascript脚本，美术资源和webview组件封装在一起。经过测试发现本地加载读取是可行的，于是安装包分分钟就做好了。很快小编在苹果商店做好了文字说明，截图以及安装包上传。正在为自己的高效工作沾沾自喜，几天后苹果的测试结果就打回来了，拒绝上线，原因却是游戏中仍保留了一封内测的邮件。







 




　　所以不管是游戏内部还是游戏描述，千万不要有“内测”啊，test啊，demo啊， beta啊这些字样，苹果会以为你对用户不负责，拿用户来测试你的产品。（可国内的页游为了规避政策不都这么做的嘛 =_=...）很快我们就删掉了所有相关字眼，仔细检查后，怀着忐忑的心情，再次提交AppStore。
　　一周后，杯具继续传来，我们又被拒了。
　　这次被拒绝的原因是游戏的内置付费问题。苹果上网游的内置付费的道具的标价很重要，单价千万不要超过99美金。我们的某个道具单价为648￥，完全超过99美金。于是我们被打回，继续埋头修改，将单价降到 68￥，继续提交，虔诚的等待结果。（看来太过于贪婪真的是祸根呀...囧rg）
　　可是福不双至，祸不单行，结果又被打回。苹果说，你的道具一次性售出的总价也不能超过99美金。这个怎么理解呢？我们将道具单价将为 68￥，但是我们允许用户一次性购买10份，那总价就是680￥，结果又毫无压力超出99美金。苹果说了，这还是不行啊，总价也不能超过99美金啊，于是我们又哼哧哼哧修改，改好提交上去了。（分特，你早怎么不说呢。对于游戏内计费的苛刻，苹果也算是计较到了极点，其实放在国内的哪个商店或者平台不是都希望扣用户钱越多越好呢~）







 




　　然后我们就在欢天喜地中又迎来了第四次被打回。这次依然是付费问题。这一次比较小纠结。上回不是说总价也不能超过99美金嘛，那好办，当用户购买5份，以及以上的份数，我们都不予他购买。这是神马意思呢，玩家点旁边那个 加号，加到5以后，他点购买会没有反应，但是加到5之前，都是正常购买的。这不是为了响应苹果的号召，总价必须低于99美金嘛。但是苹果又喊停了，为啥呢？为啥我加到5没反应啊？这是bug! 既然你不允许玩家买5份，干嘛你又允许玩家加到5呢？于是我们无言以对，又默默把 5以及 5以上的选择都取消了，点加号只能加到4...(哇呀呀，心中无数只草泥马奔腾而过呀~)
　　2）搬来高手精研学习，评审经验互通有无
　　接二连三的被打回，让几个老大们真的着急了。眼瞅着就要过年，大家实在都一筹莫展。实在不行就去找高手聊聊吧，于是几个老大出面，请到了几位据说是有着与苹果丰富斗争经验的大牛来到公司座谈交流。“三个臭皮匠，顶一个诸葛亮” 尔后大家针对我们的游戏产品给出了不少干货的建议。他们建议关键字的选择不要涉及版权，建议尽量多的把文字写在游戏截图上，建议图标设计的需要把握的尺度，不要贪心一次提交很多版本，同时也给了第一次接到苹果审核的拒绝结果后两个小时应该有的反馈...林林总总这里就不一一赘述了。但这让我想起了曾经的高考前夕，化学老师曾对小编说过的那些话，七月流火，八月融金，数百高考判卷老师汇集火炉南京挥汗如雨给百万考生审卷，你们想想如果字迹不工整，卷面不整洁下场会是如何？囧rg，我想苹果的审核大神们估计也有同感吧。终于在同志们的春天般关怀下，我们终于把看似完美的包提交了上去，再次忐忑不安的等待着再次表白的结果...







 




　　3）连受打击屡败屡战，咬牙切齿Web拒版
　　最最不幸的事情终于发生了，我们的游戏在春节前最后一周接到了苹果的「病危通知书」，他说我们的游戏是基于web的游戏，建议我们提交给流量几乎为零的WebAppStore，宛如一桶凉水泼下来，从头到脚，这基本宣判了我们产品的死刑，（T_T）。我怀着沮丧的心情回家度过了难忘的2013年春节，强颜欢笑，食不知味…
　　4）炮竹一声辞别旧岁，来年新春路转峰回
　　春节收假后，大家重新回到了公司。心有不甘有木有，各种撞墙有木有，于是老大把项目组的人重新召集到了大会议室开小诸葛会。虽然桌上摊满了各地带回来的特色零食，可是谁也没有心情吃，很快你一言我一语气氛开始活跃起来，讨论目标就是如何能让《猎魔佣兵》正式上线。首先我们检查了一下之前所碰到的各种零零碎碎的问题，都可以得到了技术和产品的全面解决。我们又找到了AppStore上有一部分跟我们类似的原生与网页混合打包产品，分析后得出的结论是，无论从画面，还是用户操作，投入一些细节的设计和修改，我们是可以把Webapp产品做到原生的体验，同时也捂脸之前图快图省事的想法。一方面我们也觉得是否在于之前被打回来的次数过多，所以苹果加强了对我们这款游戏的审核力度，导致最后杯具的结局。通过分析出这些原因，也就详细的拟定了修改的方案，安排技术大牛光哥又重新开始了我们的苹果之旅。
　　这一次我们大大增加了原生代码的数量，将游戏的登录注册选服加载客服等等界面都用原生代码完成，适当的增加了动画特效，进入游戏后，我们替换了底栏菜单和聊天部分，同时加入了游戏的背景音乐。新完成的安装包，基本可以说原生代码和网页脚本比例达到了3:7的程度。
　　最后我们重新注册了苹果账号，换了个马甲，继续提交（你懂的）。
　　结果很快下来了，Ready for sale，过了！







 




　　5）回首长叹经验总结
　　经过这一番折腾，老大让我总结一下这次的经验，不过我一直觉得最大的决定因素还是在于人品，人品值不行的还需要继续修炼呀。(*^__^*)
　　1）苹果的审核确实非常尽职尽责，每一个可能的细节都不会放过。但感觉单机游戏如果只是下载收费要比有内置计费的网游容易通过的多，所以网游开发的同学们一定要在计费接口部分多下功夫，一定要严格遵守苹果的规范呀！
　　2）在提交时候，不要贪心同时提交iPhone和iPad两个版本，我们因为《猎魔佣兵》是HTML5技术可以自动适配屏幕分辨率于是全机型打钩提交上去，结果被苹果打回来的时候告知完全没区别嘛，囧rg
　　3）HTML5的游戏开发应该尽量使用Canvas来渲染画面，而Dom可以用在菜单和一些文字输入类控件即可。原生代码则主要用来制作框架容器和部分菜单，并且完成游戏进入前的界面和各种动画特效，声音声效的播放以及对话框和聊天部分。所有游戏第一次进入用到的图像和声音等资源打包为bundle模式，全部放在本地，更多的地图，副本的图像声音资源可以考虑分阶段下载。最后我们完成的安装包大小为33M，便于下载安装。一句话，多加一些Native的代码让你的HTML5游戏产品制作的更加接近原生体验吧！
　　4）苹果对于Webapp的顾虑可能会在外链，第三方计费控制等问题吧，所以我建议这方面还是老实一点，不耍小聪明，万一上了线乱搞也有可能会被苹果踢下来。因此我们也会继续踏踏实实的做好游戏产品，遵守苹果的规范，认真服务于玩家。
　　5）在游戏的打包中我们也可以通过原生代码不但增加了一键登录同时也把第三方统计平台加入进来，比如友盟，appcpa等等。
　　不过说到这里恐怕会有不少看官质疑，你们干脆用原生开发多好呀，干嘛非死乞白赖的用HTML5打包呢？我下面就阐述一下我们之所以选用HTML5技术开发手机游戏的理由：
　　1）用HTML5开发手机应用和游戏的效率会稍高一些，成本也会略有降低。这主要体现在各种智能手机终端的移植上，我们前端都是javascript工程师，而打包移植的工作有1个人就可以快速搞定。不需要同时维护若干个团队和若干个版本。
　　2）用HTML5开发，游戏升级版本更新会更方便，只要不涉及原生代码的改动，我们都可以在后台安排脚本更新即可，无需用户再去下载安装覆盖等麻烦，也减少了因此而带来的用户流失。
　　3）用HTML5开发的网页游戏跨平台的能力较强，可以运行在PC，平板，手机等所有支持HTML5的浏览器内，这样可以让玩家无论是在电脑还是手机都可以跨平台体验游戏的乐趣，从后台数据看，大部分用户是愿意接受在不同的时段使用不同设备，电脑和手机来体验我们的游戏。
　　4）HTML5开发手机应用和游戏相对来讲会比较安全，由于浏览器的限制，我们是无法读取用户的隐私信息或设置暗扣陷阱。
　　5）虽然HTML5页游有以上的好处，但目前HTML5游戏的市场环境还并不成熟，很多用户还是比较习惯安装app来玩游戏的习惯，所以我们也采用同时推安装包和链接两种方式来尽可能的覆盖我们的用户群，因此webapp的推广方式还是非常灵活的。
　　我们作为一个HTML5页游的创业团队已经根植这项技术3年了，这期间我们从未对自己的方向有所怀疑，我们也欣喜的看到随着浏览器发展越来越成熟，我们的伙伴也越来越多，吾道不孤矣。我们也希望通过这篇小文，也带给跟我们一样在路上的伙伴们一些鼓励，一点帮助。加油！最后借此文感谢项目中一直努力奉献和付出的大牛光哥，跃强，雪冰，高妹，Cae还有小寒，何叶等等同学们，没有你们的百折不挠顽强努力，上线是不可能的！






《戏游纪》有游戏圈里的八卦、趣闻，也有圈内的重大消息。欢迎来稿，告诉我们您发现的游戏圈里的那些事，投稿邮箱：itnews(at)sohu-inc.com。 您可以通过微信扫描左侧二维码或是搜索“sohu-game”来与我们互动。